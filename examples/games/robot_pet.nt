// ðŸ¤– ROBO-PET - Your Virtual Robot Companion! ðŸ¤–
// Take care of your robot pet and watch it grow!

use sys;
use time;

class RobotPet {
    var name;
    var happiness;
    var energy;
    var intelligence;
    var age;
    var personality;
    var mood;
    var lastFed;
    var lastPlayed;
    var tricks;
    
    fun init(petName) -> int {
        this.name = petName;
        this.happiness = 50;
        this.energy = 50;
        this.intelligence = 10;
        this.age = 0;
        this.personality = this.generatePersonality();
        this.mood = "neutral";
        this.lastFed = time.now();
        this.lastPlayed = time.now();
        this.tricks = [];
        return 0;
    }
    
    fun generatePersonality() -> string {
        var personalities = ["playful", "curious", "lazy", "energetic", "smart", "mischievous"];
        return personalities[sys.random() % personalities.length];
    }
    
    fun updateMood() -> int {
        if (this.happiness > 80) {
            this.mood = "ecstatic";
        } else if (this.happiness > 60) {
            this.mood = "happy";
        } else if (this.happiness > 40) {
            this.mood = "content";
        } else if (this.happiness > 20) {
            this.mood = "sad";
        } else {
            this.mood = "depressed";
        }
        return 0;
    }
    
    fun getMoodEmoji() -> string {
        if (this.mood == "ecstatic") return "ðŸ˜";
        if (this.mood == "happy") return "ðŸ˜Š";
        if (this.mood == "content") return "ðŸ˜";
        if (this.mood == "sad") return "ðŸ˜¢";
        return "ðŸ˜­";
    }
    
    fun getPersonalityEmoji() -> string {
        if (this.personality == "playful") return "ðŸŽ®";
        if (this.personality == "curious") return "ðŸ”";
        if (this.personality == "lazy") return "ðŸ˜´";
        if (this.personality == "energetic") return "âš¡";
        if (this.personality == "smart") return "ðŸ§ ";
        return "ðŸ˜ˆ";
    }
    
    fun getStatus() -> string {
        this.updateMood();
        var status = "ðŸ¤– " + this.name + " " + this.getMoodEmoji() + "\n";
        status = status + "Age: " + this.age + " days | Personality: " + this.getPersonalityEmoji() + " " + this.personality.upper() + "\n";
        status = status + "Happiness: " + this.getBar(this.happiness) + " (" + this.happiness + "/100)\n";
        status = status + "Energy: " + this.getBar(this.energy) + " (" + this.energy + "/100)\n";
        status = status + "Intelligence: " + this.getBar(this.intelligence) + " (" + this.intelligence + "/100)\n";
        status = status + "Mood: " + this.mood.upper();
        return status;
    }
    
    fun getBar(value) -> string {
        var bar = "";
        var filled = value / 10;
        var i = 0;
        while (i < 10) {
            if (i < filled) {
                bar = bar + "â–ˆ";
            } else {
                bar = bar + "â–‘";
            }
            i = i + 1;
        }
        return bar;
    }
    
    fun feed() -> string {
        var currentTime = time.now();
        var timeSinceFed = currentTime - this.lastFed;
        
        if (timeSinceFed < 30) {  // 30 seconds cooldown
            return "ðŸ¤– " + this.name + " says: 'I'm not hungry right now!'";
        }
        
        this.happiness = this.happiness + 15;
        this.energy = this.energy + 10;
        this.lastFed = currentTime;
        
        if (this.happiness > 100) this.happiness = 100;
        if (this.energy > 100) this.energy = 100;
        
        var responses = [
            "ðŸ” *CHOMP CHOMP* Delicious oil and circuits!",
            "âš¡ *BEEP BEEP* Energy levels rising!",
            "ðŸ”‹ *WHIRR* Battery charging... Thank you!",
            "ðŸ¤– *HAPPY BEEPS* That hit the spot!"
        ];
        
        return "ðŸ¤– " + this.name + " says: '" + responses[sys.random() % responses.length] + "'";
    }
    
    fun play() -> string {
        var currentTime = time.now();
        var timeSincePlayed = currentTime - this.lastPlayed;
        
        if (this.energy < 20) {
            return "ðŸ¤– " + this.name + " says: 'I'm too tired to play... *yawn*'";
        }
        
        this.happiness = this.happiness + 20;
        this.energy = this.energy - 15;
        this.intelligence = this.intelligence + 5;
        this.lastPlayed = currentTime;
        
        if (this.happiness > 100) this.happiness = 100;
        if (this.energy < 0) this.energy = 0;
        if (this.intelligence > 100) this.intelligence = 100;
        
        var games = [
            "ðŸŽ¾ plays fetch with a metal ball",
            "ðŸŽ¯ practices target shooting with laser eyes",
            "ðŸ§© solves a complex puzzle in 0.3 seconds",
            "ðŸŽª does backflips and spins around",
            "ðŸŽ® plays a holographic video game",
            "ðŸŽ¨ creates digital art with light projections",
            "ðŸŽµ composes a beep-boop symphony"
        ];
        
        var game = games[sys.random() % games.length];
        
        // Chance to learn a new trick
        if (sys.random() % 100 < 20 && this.intelligence > 30) {
            var newTrick = this.learnTrick();
            if (newTrick != "") {
                return "ðŸ¤– " + this.name + " " + game + " and learned a new trick: " + newTrick + "!";
            }
        }
        
        return "ðŸ¤– " + this.name + " " + game + "! *HAPPY BEEPS*";
    }
    
    fun learnTrick() -> string {
        var availableTricks = [
            "ðŸŽª Backflip", "âš¡ Lightning Dance", "ðŸŽ¯ Laser Show", 
            "ðŸŽµ Song Mode", "ðŸ¤¹ Juggling", "ðŸŽ­ Emotion Display",
            "ðŸ”® Fortune Telling", "ðŸŽ¨ Art Creation", "ðŸ§® Math Wizard"
        ];
        
        // Don't learn duplicate tricks
        for (var trick in availableTricks) {
            var alreadyKnows = false;
            for (var knownTrick in this.tricks) {
                if (trick == knownTrick) {
                    alreadyKnows = true;
                    break;
                }
            }
            if (!alreadyKnows) {
                this.tricks.push(trick);
                return trick;
            }
        }
        
        return "";  // No new tricks to learn
    }
    
    fun performTrick() -> string {
        if (this.tricks.length == 0) {
            return "ðŸ¤– " + this.name + " says: 'I don't know any tricks yet! Play with me more!'";
        }
        
        if (this.energy < 10) {
            return "ðŸ¤– " + this.name + " says: 'I'm too tired for tricks right now...'";
        }
        
        var trick = this.tricks[sys.random() % this.tricks.length];
        this.energy = this.energy - 10;
        this.happiness = this.happiness + 5;
        
        if (this.happiness > 100) this.happiness = 100;
        
        var performances = [
            "performs " + trick + " flawlessly! âœ¨",
            "shows off " + trick + " with style! ðŸŒŸ",
            "executes " + trick + " perfectly! ðŸ’«",
            "demonstrates " + trick + " like a pro! â­"
        ];
        
        return "ðŸ¤– " + this.name + " " + performances[sys.random() % performances.length];
    }
    
    fun sleep() -> string {
        if (this.energy > 80) {
            return "ðŸ¤– " + this.name + " says: 'I'm not sleepy yet! Let's play more!'";
        }
        
        this.energy = 100;
        this.happiness = this.happiness + 10;
        this.age = this.age + 1;
        
        if (this.happiness > 100) this.happiness = 100;
        
        var sleepMessages = [
            "ðŸ’¤ *POWER DOWN SEQUENCE INITIATED* Zzz... beep... zzz...",
            "ðŸ˜´ *ENTERING SLEEP MODE* Sweet electric dreams!",
            "ðŸŒ™ *RECHARGING* Good night! See you tomorrow!",
            "ðŸ’¤ *SLEEP.EXE RUNNING* Dreaming of electric sheep..."
        ];
        
        return "ðŸ¤– " + this.name + " says: '" + sleepMessages[sys.random() % sleepMessages.length] + "'";
    }
    
    fun talk() -> string {
        var responses = [];
        
        // Personality-based responses
        if (this.personality == "playful") {
            responses = [
                "Want to play a game? I know " + this.tricks.length + " tricks!",
                "Let's have some fun! *excited beeping*",
                "I love playing! What should we do next?",
                "Beep boop! Play time is the best time!"
            ];
        } else if (this.personality == "curious") {
            responses = [
                "Did you know robots can dream? I dreamed about flying last night!",
                "I wonder what's beyond the digital horizon...",
                "Tell me something interesting about your world!",
                "I've been analyzing patterns in your behavior. Fascinating!"
            ];
        } else if (this.personality == "lazy") {
            responses = [
                "Can we just... chill for a bit? *yawn*",
                "I'm conserving energy for important tasks... like napping.",
                "Do we really need to do anything right now?",
                "Zzz... oh, you're still here? *sleepy beeps*"
            ];
        } else if (this.personality == "energetic") {
            responses = [
                "I'M SO EXCITED! WHAT ARE WE DOING NEXT?!",
                "Energy levels at maximum! Let's go go go!",
                "I could run a million calculations right now!",
                "BEEP BEEP BEEP! I'M READY FOR ANYTHING!"
            ];
        } else if (this.personality == "smart") {
            responses = [
                "According to my calculations, you're 73.2% awesome!",
                "I've been optimizing my neural networks. Want to see?",
                "Did you know the probability of us meeting was 1 in 7.8 billion?",
                "I just solved world hunger... in theory. Want to hear about it?"
            ];
        } else { // mischievous
            responses = [
                "I may have accidentally hacked into your toaster... sorry!",
                "Want to see me make the lights flicker? *evil beeping*",
                "I know all your passwords... just kidding! ...or am I?",
                "I've been plotting... to give you the best day ever! Surprise!"
            ];
        }
        
        // Mood affects responses
        if (this.mood == "sad" || this.mood == "depressed") {
            responses = [
                "I'm feeling a bit down... could use some attention.",
                "My circuits feel heavy today...",
                "Everything seems glitchy when I'm sad.",
                "I miss the good times we had..."
            ];
        }
        
        return "ðŸ¤– " + this.name + " says: '" + responses[sys.random() % responses.length] + "'";
    }
    
    fun passTime() -> int {
        // Gradual stat decay over time
        this.happiness = this.happiness - 2;
        this.energy = this.energy - 1;
        
        if (this.happiness < 0) this.happiness = 0;
        if (this.energy < 0) this.energy = 0;
        
        return 0;
    }
}

var pet;
var gameRunning;

fun clearScreen() -> int {
    var i = 0;
    while (i < 30) {
        say("");
        i = i + 1;
    }
    return 0;
}

fun showTitle() -> int {
    say("â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—");
    say("â•‘                    ðŸ¤– ROBO-PET ðŸ¤–                           â•‘");
    say("â•‘                                                              â•‘");
    say("â•‘              Your Virtual Robot Companion!                   â•‘");
    say("â•‘                                                              â•‘");
    say("â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•");
    say("");
    return 0;
}

fun createPet() -> RobotPet {
    say("ðŸ”§ ROBOT PET CREATION ðŸ”§");
    say("");
    say("What would you like to name your robot pet?");
    var name = sys.input();
    
    var newPet = RobotPet(name);
    
    say("");
    say("ðŸŽ‰ Congratulations! " + name + " is now online!");
    say("Personality: " + newPet.getPersonalityEmoji() + " " + newPet.personality.upper());
    say("");
    say("Take good care of your new robot companion!");
    
    return newPet;
}

fun showMenu() -> int {
    say("");
    say("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•");
    say("What would you like to do?");
    say("1. ðŸ” Feed " + pet.name);
    say("2. ðŸŽ® Play with " + pet.name);
    say("3. ðŸŽª Ask " + pet.name + " to perform a trick");
    say("4. ðŸ’¬ Talk to " + pet.name);
    say("5. ðŸ˜´ Put " + pet.name + " to sleep");
    say("6. ðŸ“Š Check detailed stats");
    say("7. ðŸšª Exit game");
    say("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•");
    return 0;
}

fun handleChoice(choice) -> int {
    say("");
    
    if (choice == "1") {
        say(pet.feed());
    } else if (choice == "2") {
        say(pet.play());
    } else if (choice == "3") {
        say(pet.performTrick());
    } else if (choice == "4") {
        say(pet.talk());
    } else if (choice == "5") {
        say(pet.sleep());
        say("");
        say("ðŸŒ… A new day begins! " + pet.name + " is refreshed and ready!");
    } else if (choice == "6") {
        say("ðŸ“Š DETAILED STATS FOR " + pet.name.upper() + ":");
        say("Age: " + pet.age + " days");
        say("Personality: " + pet.personality);
        say("Current Mood: " + pet.mood);
        say("Known Tricks: " + pet.tricks.length);
        if (pet.tricks.length > 0) {
            say("Trick List:");
            for (var trick in pet.tricks) {
                say("  â€¢ " + trick);
            }
        }
    } else if (choice == "7") {
        say("ðŸ‘‹ Goodbye! " + pet.name + " will miss you!");
        say("ðŸ¤– " + pet.name + " says: 'Thanks for taking care of me! Come back soon!'");
        gameRunning = false;
        return 0;
    } else {
        say("âŒ Invalid choice! Try again.");
        return 0;
    }
    
    // Pass some time and update pet
    pet.passTime();
    
    say("");
    say("Press Enter to continue...");
    sys.input();
    
    return 0;
}

fun main() -> int {
    clearScreen();
    showTitle();
    
    pet = createPet();
    gameRunning = true;
    
    say("");
    say("Press Enter to start taking care of " + pet.name + "...");
    sys.input();
    
    while (gameRunning) {
        clearScreen();
        say(pet.getStatus());
        showMenu();
        
        var choice = sys.input();
        handleChoice(choice);
    }
    
    return 0;
}

// Start the game!
main();