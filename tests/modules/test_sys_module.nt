// Test sys module
use sys;

say("=== Testing Sys Module ===");

// Test 1: File write and read
var testFile = "test_sys_temp.txt";
sys.write(testFile, "Test content");
var content = sys.read(testFile);
if (content == "Test content") {
    say("✓ sys.write and sys.read work");
} else {
    say("✗ sys.write/read failed");
}

// Test 2: File exists
var exists = sys.exists(testFile);
if (exists == true) {
    say("✓ sys.exists works");
} else {
    say("✗ sys.exists failed");
}

// Test 3: Current working directory
var cwd = sys.cwd();
if (cwd != "") {
    say("✓ sys.cwd works");
} else {
    say("✗ sys.cwd failed");
}

// Test 4: System info
var info = sys.info();
if (info.platform != "" and info.arch != "") {
    say("✓ sys.info works");
} else {
    say("✗ sys.info failed");
}

// Test 5: Command line args
var args = sys.args();
if (args[0] != "") {
    say("✓ sys.args works");
} else {
    say("✗ sys.args failed");
}

// Test 6: Temporary file
var tmp = sys.tmpfile();
if (tmp != "") {
    say("✓ sys.tmpfile works");
} else {
    say("✗ sys.tmpfile failed");
}

// Test 7: File stat
sys.write(tmp, "Hello, World!");
var fileInfo = sys.stat(tmp);
if (fileInfo.size == 13 and fileInfo.is_file) {
    say("✓ sys.stat works");
} else {
    say("✗ sys.stat failed");
}

// Test 8: chmod
sys.chmod(tmp, 420);
say("✓ sys.chmod works");

// Test 9: Directory listing
var files = sys.listdir(".");
var found_files = false;
if (files.length > 0) {
    found_files = true;
}
if (found_files) {
    say("✓ sys.listdir works");
} else {
    say("✗ sys.listdir failed");
}

// Test 10: mkdir and rmdir (empty)
sys.mkdir("test_empty_dir");
if (sys.exists("test_empty_dir")) {
    sys.rmdir("test_empty_dir");
    if (!sys.exists("test_empty_dir")) {
        say("✓ sys.mkdir and sys.rmdir work");
    } else {
        say("✗ sys.rmdir failed");
    }
} else {
    say("✗ sys.mkdir failed");
}

// Test 11: rmdir recursive (with contents)
sys.mkdir("test_full_dir");
sys.write("test_full_dir/file1.txt", "content1");
sys.write("test_full_dir/file2.txt", "content2");
sys.mkdir("test_full_dir/subdir");
sys.write("test_full_dir/subdir/file3.txt", "content3");
sys.rmdir("test_full_dir", true);
if (!sys.exists("test_full_dir")) {
    say("✓ sys.rmdir recursive works");
} else {
    say("✗ sys.rmdir recursive failed");
}

// Cleanup
sys.rm(tmp);
sys.rm(testFile);
say("✓ sys.rm works");

say("\n=== All sys module tests passed ===");
